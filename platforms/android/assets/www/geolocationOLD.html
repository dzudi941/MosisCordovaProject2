<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="cordova.js"></script>
    <script src="js/jquery-1.10.1.min.js"></script>
    <link href="theme/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!--<link href="theme/jasny-bootstrap/css/jasny-bootstrap.css" rel="stylesheet">-->
    <link href="css/style.css" rel="stylesheet">

    <script type="text/javascript">
      var db = null;

    document.addEventListener('deviceready', function() {
        $('#well').hide();
        db = window.sqlitePlugin.openDatabase({name: 'kud.db', location: 'default'});
        var mapDiv = document.getElementById("map_canvas");
        var map = plugin.google.maps.Map.getMap(mapDiv);
         PositionChanged = function (position){
          //console.log(position);
          const MY_Location = new plugin.google.maps.LatLng(position.coords.latitude, position.coords.longitude);
          if (sessionStorage.MapEnapbled != undefined) {
            map.remove();
            map = plugin.google.maps.Map.getMap(mapDiv, {
              'camera': {
                'latLng': MY_Location,
                'zoom': 15
              }
            });
          }

        sessionStorage.MapEnapbled = true;

        
        map.setCenter(MY_Location);

        map.setClickable( true );
        }//positionChangedCLose

        $('.collapse').on('shown.bs.collapse', function(e) {          
                map.setClickable( false );
        });
        $('.collapse').on('hidden.bs.collapse', function(e) { 
            map.setClickable( true );
        });

        $('#map_canvas, #X-button').on('click', function(e) {
          if (e.target !== this)
            return;
          
          $('#well').hide();
          map.setClickable( true );
        });

        


        navigator.geolocation.getCurrentPosition(PositionChanged);
    });
    
    </script>
  </head>
  <body>
  <div id="menu"></div>

  <div style="/*margin-top: 100px;*/ width:100%;height: 100vh;margin-top: -20px;" id="map_canvas"></div>

    
    <script type="text/javascript">
      $('#menu').load('menu.html');
    </script>
        <!--<script src="theme/jquerymobile/jquery.mobile-1.4.5.min.js"></script>-->
        <script src="theme/bootstrap/js/bootstrap.min.js"></script>
        <!--<script src="theme/jasny-bootstrap/js/jasny-bootstrap.min.js"></script>-->
  </body>
</html>